<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Usage · SDPAFamily.jl</title><link rel="canonical" href="https://ericphanson.github.io/SDPAFamily.jl/usage/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">SDPAFamily.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li class="is-active"><a class="tocitem" href>Usage</a><ul class="internal"><li><a class="tocitem" href="#Using-a-number-type-other-than-BigFloat"><span>Using a number type other than <code>BigFloat</code></span></a></li><li><a class="tocitem" href="#Using-presolve"><span>Using presolve</span></a></li><li><a class="tocitem" href="#Changing-parameters-and-solving-at-very-high-precision"><span>Changing parameters &amp; solving at very high precision</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../issues/">Possible Issues &amp; Troubleshooting</a></li><li><a class="tocitem" href="../reference/">Developer reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Usage</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ericphanson/SDPAFamily.jl/blob/master/docs/src/usage.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h1><p>The main object of interest supplied by this package is <code>SDPAFamily.Optimizer{T}()</code>. Here, <code>T</code> is a numeric type which defaults to <code>BigFloat</code>. Keyword arguments may also be passed to <code>SDPAFamily.Optimizer()</code>:</p><ul><li><code>variant</code>: either <code>:sdpa_gmp</code>, <code>:sdpa_qd</code>, or <code>:sdpa_dd</code>, to use SDPA-GMP, SDPA-QD, or SDPA-DD, respectively. Defaults to <code>:sdpa_gmp</code>.</li><li><code>silent</code>: a boolean to indicate whether or not to print output. Defaults to <code>false</code>.</li><li><code>verbose</code>: accepts either <code>SDPAFamily.SILENT</code> (which is equivalent to <code>silent=true</code>), <code>SDPAFamily.WARN</code> (which is the default), or <code>SDPAFamily.VERBOSE</code>, which prints all output from the binary as well as additional warnings.</li><li><code>presolve</code>: whether or not to run a presolve routine to remove linearly dependent constraints. See below for more details. Defaults to <code>false</code>. Note, <code>presolve=true</code> is required to pass many of the tests for this package; linearly independent constraints are an assumption of the SDPA-family, but constraints generated from high level modelling languages often do have linear dependence between them.</li><li><code>binary_path</code>: a string representing a path to the SDPA-GMP binary to use. The default is chosen at <code>build</code> time. To change the default binaries, see <a href="../installation/#Custom-binary">Custom binary</a>.</li><li><code>params</code>: either <code>SDPAFamily.DEFAULT</code> (the default option), <code>SDPAFamily.UNSTABLE_BUT_FAST</code>, <code>SDPAFamily.STABLE_BUT_SLOW</code>, a <code>NamedTuple</code> giving a list of choices of parameters (e.g. <code>params = (maxIteration=600,)</code>), an <a href="../reference/#SDPAFamily.Params"><code>SDPAFamily.Params</code></a> object, or or a string representing a path to a custom parameter file. See <a href="../reference/#SDPAFamily.Params"><code>SDPAFamily.Params</code></a> for the possible choices of parameters.</li></ul><p>The default parameters used by <code>SDPAFamily.jl</code> depend on the variant and numeric type, and can be found as the default values in the source code <a href="https://github.com/ericphanson/SDPAFamily.jl/tree/master/src/params.jl">here</a>. The choices choices of parameters <code>UNSTABLE_BUT_FAST</code> and <code>STABLE_BUT_SLOW</code> are documented in the <a href="https://sourceforge.net/projects/sdpa/files/sdpa/sdpa.7.1.1.manual.20080618.pdf">SDPA users manual</a>, as well as the meaning of each parameter. A new parameter file is generated for each optimizer instance <code>opt</code> (and is regenerated for each solve), and can be found in the directory <code>opt.tempdir</code>, along with the SDPA-format input and output files for the problem, assuming a custom parameter file has not been passed to the optimizer. See <a href="#Changing-parameters-and-solving-at-very-high-precision">Changing parameters &amp; solving at very high precision</a> below for an example.</p><p><code>SDPAFamily.Optimizer()</code> also accepts <code>variant = :sdpa</code> to use the non-high-precision SDPA binary. For general usage of the SDPA solver, use <a href="https://github.com/JuliaOpt/SDPA.jl">SDPA.jl</a> which uses the C++ library to interface directly with the SDPA binary.</p><h2 id="Using-a-number-type-other-than-BigFloat"><a class="docs-heading-anchor" href="#Using-a-number-type-other-than-BigFloat">Using a number type other than <code>BigFloat</code></a><a id="Using-a-number-type-other-than-BigFloat-1"></a><a class="docs-heading-anchor-permalink" href="#Using-a-number-type-other-than-BigFloat" title="Permalink"></a></h2><p><code>SDPAFamily.Optimizer()</code> uses <code>BigFloat</code> for problem data and solution by default. To use, for example, <code>Float64</code> instead, simply call <code>SDPAFamily.Optimizer{Float64}()</code>. However, this may cause underflow errors when reading the solution file, particularly when <code>MathOptInterface</code> bridges are used. Note that with <code>MathOptInterface</code> all the problem data must be parametrised by the same number type, i.e. <code>Float64</code> in this case.</p><h2 id="Using-presolve"><a class="docs-heading-anchor" href="#Using-presolve">Using presolve</a><a id="Using-presolve-1"></a><a class="docs-heading-anchor-permalink" href="#Using-presolve" title="Permalink"></a></h2><p>SDPA-GMP will emit <code>cholesky miss condition :: not positive definite</code> error when the problem data contain linearly dependent constraints. Set <code>presolve=true</code> to use a presolve routine which tries to detect such constraints by Gaussian elimination. The redundant constraints are omitted from the problem formulation and the corresponding redundant decision variables are set to 0 in the final result. The time taken to perform the presolve step depends on the size of the problem. This process is numerically unstable, so is disabled by default. It does help quite a lot with some problems, however.</p><p>We demonstrate <code>presolve</code> using the problem defined in <a href="../examples/#Optimal-guessing-probability-for-a-pair-of-quantum-states">Optimal guessing probability for a pair of quantum states</a>. When <code>presolve</code> is disabled, SDPA solvers will terminate prematurely due to linear dependence in the input constraints. Note, however, that this does not necessarily happen. Empirically, for our test cases, solvers&#39; intolerance to redundant constraints increases from <code>:sdpa</code> to <code>:sdpa_gmp</code>.</p><pre><code class="language-julia-repl">julia&gt; solve!(problem, () -&gt; SDPAFamily.Optimizer(presolve = false))
Warning: cholesky miss condition :: not positive definite :: info = 36 :: line 643 in sdpa_linear.cpp
┌ Warning: &#39;cholesky miss condition&#39; warning detected; results may be unreliable. Try `presolve=true`, or see troubleshooting guide.
└ @ SDPAFamily ~/work/SDPAFamily.jl/SDPAFamily.jl/src/binary_call.jl:54
┌ Warning: Problem status ITERATION_LIMIT; solution may be inaccurate.
└ @ Convex ~/.julia/packages/Convex/Zv1ch/src/solution.jl:253</code></pre><p>Applying presolve helps by removing 8 redundant constraints from the final input file.</p><pre><code class="language-julia-repl">julia&gt; solve!(problem, () -&gt; SDPAFamily.Optimizer(presolve = true))

julia&gt; @test problem.optval ≈ 1//2 + 1/(2*sqrt(big(2))) atol=1e-30
Test Passed</code></pre><p>We see we have recovered the true answer to a tolerance of <span>$10^{-30}$</span>.</p><h2 id="Changing-parameters-and-solving-at-very-high-precision"><a class="docs-heading-anchor" href="#Changing-parameters-and-solving-at-very-high-precision">Changing parameters &amp; solving at very high precision</a><a id="Changing-parameters-and-solving-at-very-high-precision-1"></a><a class="docs-heading-anchor-permalink" href="#Changing-parameters-and-solving-at-very-high-precision" title="Permalink"></a></h2><p>Continuing the above example, we can also increase the precision by changing the default parameters:</p><pre><code class="language-julia-repl">julia&gt; opt = () -&gt; SDPAFamily.Optimizer(
           presolve = true,
           params = (  epsilonStar = 1e-200, # constraint tolerance
                       epsilonDash = 1e-200, # normalized duality gap tolerance
                       precision = 2000 # arithmetric precision used in sdpa_gmp
           ))
#7 (generic function with 1 method)

julia&gt; setprecision(2000) # set Julia&#39;s global BigFloat precision to 2000
2000

julia&gt; ρ₁ = Complex{BigFloat}[1 0; 0 0]
2×2 Array{Complex{BigFloat},2}:
 1.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im

julia&gt; ρ₂ = (1//2)*Complex{BigFloat}[1 -im; im 1]
2×2 Array{Complex{BigFloat},2}:
 0.50+0.0im    0.0-0.50im
  0.0+0.50im  0.50+0.0im

julia&gt; E₁ = ComplexVariable(2, 2);

julia&gt; E₂ = ComplexVariable(2, 2);

julia&gt; problem = maximize( real((1//2)*tr(ρ₁*E₁) + (1//2)*tr(ρ₂*E₂)),
                           [E₁ ⪰ 0, E₂ ⪰ 0, E₁ + E₂ == Diagonal(ones(2))];
                           numeric_type = BigFloat );

julia&gt; solve!(problem, opt)

julia&gt; p_guess = 1//2 + 1/(2*sqrt(big(2)))
0.8535533905932737622004221810524245196424179688442370182941699344976831196155267597125968835819103931837534615577280742562312090139626843031610303742749839578533056664818763981889499876252881955151428675273899929014925686336492155036821293546602222996523880823076210771785803627099406509069988128519974218133491365829522074101551538145880987636864375719399904324588938050843829642528385936508521247117900967249926747512037576360069475791135619557671232342296553951446157778991671782532539046422468093088221273162153123744288554583551071421515036706180192858963718538914267419413430056621361753964700405173

julia&gt; @test problem.optval ≈ p_guess atol=1e-200
Test Passed</code></pre><p>With these parameters, we have recovered the true answer to a tolerance of <span>$10^{-200}$</span>.</p><p>Note that we called <code>setprecision(2000)</code> at the start. This is so that the <code>BigFloat</code> objects used to construct <code>ρ₁</code>, <code>ρ₂</code>, the internals of the <code>Convex.Problem</code> instance are constructed to such a precision, as well as the BigFloat objects used to store the output of SDPA-GMP. The default, <code>256</code>, is not sufficient in this case. Testing this can be a little bit subtle: for example, if <code>setprecision(2000)</code> was not called (or equivalently, <code>setprecision(256)</code> called instead), then the test</p><pre><code class="language-julia">@test problem.optval ≈ p_guess atol=1e-200</code></pre><p>would still pass. However, that is because <code>p_guess</code> is only constructed at approximately 77 digits of precision, and <code>problem.optval</code> is only read back from SDPA-GMP at the same precision. So in that case, the test isn&#39;t truly testing that the solution is accurate to 200 digits of precision.</p><p>In this case, since <code>1</code> and <code>1/2</code> are exactly representable by floating point numbers, it is enough to specify <code>setprecision(2000)</code> before the <code>solve!</code> call (so the <code>ρ₁</code> and <code>ρ₂</code> are only constructed at 256 bits of high precision), but it is good practice to set the precision at the start for the whole problem. Moreover, since the precision is mutable global state, it is best to set it once at the start of a session and not change it, or to setup and solve a problem within a single</p><pre><code class="language-julia">setprecision(2000) do
    ...
end</code></pre><p>block, to avoid any potentially confusing behavior caused by mixing precisions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../installation/">« Installation</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 23 February 2021 01:06">Tuesday 23 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
